
# **1. 开始前的准备**
　　俗话说：“**工欲善其事，必先利其器**。”凡事都要做好充足的准备。在使用自动记账之前，我们还需要做一些准备工作。

　　如果你已经做好相关准备工作，那么请直接进入[下一步](2.权限设置.md)。

　　在之前的软件介绍中，我们提到过，自动记账分为两种模式：
>- [无障碍模式](#无障碍模式)
>- [Xposed模式](#Xposed模式)<font color="#848589">（推荐）</font>
----
但现在，它们不是重点。<font color="#ff7733">无论你使用哪种模式</font>，都跟着我一起进行**最重要的第一步**：
## 钱迹配置<font color="#ff7733" size="2">（非常重要）</font> :id=qiamjiSet

   ##### 第一步、下载并安装：[钱迹](https://www.coolapk.com/apk/com.mutangtech.qianji)

   ##### 第二步、登录钱迹
?>打开`钱迹`，`注册`然后`登陆`，**如图所示：**<font size="1">（这个应该不需要手把手教了吧？~~毕竟都是读过书的人。~~）</font>

   ![钱迹登录界面](img/钱迹登录界面.jpg ':size=260')
   ![钱迹登录界面](img/钱迹登录界面2.jpg ':size=260')
   ##### 第三步、设置资产

?>登录后，点开右上角抽屉，进入`设置`，见下图：

   ![钱迹首页](img/钱迹首页.png ':size=260')
   ![钱迹抽屉](img/钱迹抽屉.png ':size=260')

?>在设置页面，进入`实验室`，找到`资产管理`，打开开关，然后回到主页面，如图所示：

   ![钱迹设置](img/钱迹设置.png ':size=260')
   ![钱迹实验室](img/钱迹实验室.png ':size=260')

?>回到主页后，`向左滑动`或`点击右上角钱包图案`，进入资产页面。然后点击`右下角`，`添加资产`。如图：

   ![钱迹首页2](img/钱迹首页2.png ':size=260')
   ![钱迹资产](img/钱迹资产.png ':size=260')

?>建议将常规资产都添加一遍。

   添加好你的资产后，我们就可以开始进入下一步了。

   ##### 第四步、设置分类
   钱迹默认有一些分类，如果你对此并不满意，那么，我们就需要修改它

?>回到主页，点击下方的`+`号

   ![钱迹首页3](img/钱迹首页3.png ':size=260')

?>点击`管理`，修改分类，这里如何修改我就不再赘述了

   ![钱迹分类](img/钱迹分类.png ':size=260')
   ![钱迹分类管理](img/钱迹分类管理.jpg ':size=260')

做到这里，钱迹的准备工作就已经基本完成了。

!>**但我们还有一件事情要做**：允许钱迹`自启动`，**这很重要！！！！**否则你将进入随缘记账时代。

还有更多的功能，大家可以自行查看钱迹的[官方文档](http://docs.qianjiapp.com/)了。

----
接下来，我们就要开始下一步:
## 环境配置<font color="#ff7733" size="2">（Xposed模式必看）</font> :id=huanjingSet
前面我们一直提到，自动记账有两种模式
>- [无障碍模式](#无障碍模式)
>- [Xposed模式](#Xposed模式)<font color="#848589">（推荐）</font>
----
### 无障碍模式
　　`无障碍模式`是利用安卓系统提供的无障碍辅助功能，读取通知及屏幕内容，该模式**高度依赖屏幕内容及App通知**，因此功能上**将会有不可避免的缺陷**。所以我们<font color="#ff7733">**并不推荐**</font>使用这一模式。

　　当然，如果你实在没有办法，只能使用无障碍模式。那么，请按照以下步骤，完成准备工作：

>**下载并安装[自动记账](https://www.coolapk.com/apk/cn.dreamn.qianji_auto)**

　　呃……好吧，你好像**不需要再准备什么**了，那就直接去下一步吧！

----
### Xposed模式

!>　　`Xposed模式`，是我们**主要推荐**的模式。主要依赖于`Xposed框架`运行。因此，使用该模式<font color="#ff7733">**需要一定的基础**</font>。至少能够懂得一些常规的搞机知识，比如：<br/>
　☞　**什么是**`刷机`**？**<br/>
　☞　**什么是**`root`**？**<br/>
　☞　**什么是**`面具(Magisk)`**？**<br/>
　☞　**什么是**`xp框架`**？**<br/>
　☞　**什么是**`模块`**？**<br/>
如果这些你都不清楚，那么**请至少学会**[百度](http://www.baidu.com)。

-----
　　在开始准备工作之前，我们可能需要了解下目前存在的几种框架：([什么玩意？爷需要你来教？直接跳过！](#Start))

>1. `原生Xposed框架`：<br/>
最为古老的框架，是所有xp框架的起源，现在已经停止维护(<font color="#949599">主要是原作者跑路了</font>)，并逐渐退出历史舞台，除非你是使用非常老旧的机器，否则可以忽略它。
2. `edXposed`：<br/>
简称`edxp`。Xposed基础上发展来的分支，依赖于`Magisk`以及`riru模块`，安装的便捷性上是优于原版的，但性能上并没有大的改进，卡顿等问题依旧存在，严重影响性能，因此，如果不是需要使用一些很偏门的模块，这个我们**并不推荐**。
3. `LSPosed`：<br/>
从`edxp`基础上发展来的新分支，同样是依赖于`magisk`和`riru`，不同的是：<br/>
　①它精简了一些极难用到的指令；<br/>
　②采用强制作用域的方式，使模块只作用在需要的应用上，而不会全局生效；<br/>
　③全面使用C++重构代码。<br/>
基于以上几点，LSP在性能上的改进，可以称得上是革命性的。因此，我们<font color="#ff8833">**强烈推荐**</font>使用LSP（如果条件允许的话）。<br/>
另外，**需要说明的是**，lsp已经**彻底放弃**了对`安卓8.0及以下`的支持，安卓8.0及以下的用户可以放弃对它的期待。
4. `太极-阳`：<br/>
太极的root模式，性能介于`edxp`和`LSPosed`之间。流畅，但没有完全流畅。在LSP横空出世前，他几乎是最优的选择了。但现在，我们推荐LSP。
5. `太极-阴`：<br/>
一款支持免root的框架，性能介于edxp和lsp之间。如果手机不能root，可以考虑使用。但我们并不推荐，因为**支付宝似乎不支持加入太极**。这意味着我们要自废一半功力。
6. `应用转生`：<br/>
同样是免root框架，但它同时支持支付宝和微信，虽然稳定性、性能等方面都不如太极，但我们依然推荐非root用户使用它，毕竟——能用总比不能用的好。

----
<font size="3">下面正式开始：</font>

~~**<font color="#3399cc" size="4">第一步、准备适量水</font>**~~

----
<font size="3">**不好意思，搞错了，重新来：**</font>

#### <font color="#3399cc">第一步、ROOT</font> :id=Start
这一步<font size="3">**并非必须的**</font>，使用`太极-阴`或`应用转生`的用户可以[<font color="#ff7733">忽略这一步</font>](#installeXp)，而使用`edxp`和`LSP`的用户，请继续往下看：

!>由于每个机型、品牌的root流程都不一样，所以这一步的工作，只能请大家自行寻找方案。<br/>
如果你使用的是`一加手机`，可以前往[这个链接](https://optool.daxiaamu.com/wiki/pctool.html)看看，结果如何<font size="4">**概不负责**</font>。

root完成后，如果你是系统自带的root权限，那么，你需要将root权限替换成Magisk。
>1. 下载并安装[Magisk Manager](https://www.coolapk.com/apk/com.topjohnwu.magisk)；
>2. 打开`magisk`，并给予`Root权限`；
>3. 点击`magisk旁边`的`安装`>`直接安装`；
>4. 完成后`重启手机`。

#### <font color="#3399cc">第二步、安装框架</font> :id=installeXp
为方便大家查找，这里设置几个跳转链接：
- [非root用户（太极-阴、应用转生）](#WithoutRoot)
- [老旧机型专属（原生Xp框架）](#OldPhone)
- [Root用户（EdXposed、太极-阳、LSPosed）](#XpWithMagisk)

!>**注意：**Xp框架建议只安装一个，不要多个同时安装，虽然它们可以共存，但是使用时可能存在某些不可预料的冲突。

##### 太极-阴和应用转生(非ROOT用户)： :id=WithoutRoot
   >1. 下载并安装[`太极`](https://www.coolapk.com/apk/me.weishu.exp)或[`应用转生`](https://dx15.198449.com/com.bug.xposed.apk)（由于没有在酷安上架，这是百度搜到的链接），无需重启手机；
   >2. 进入太极，更新并安装好框架包，这里只需要按照提示进行就好；应用转生也大体类似。
   >3. 到这里，太极和应用转生的用户就可以进入[下一步](#useModule)了。

##### 原生Xposed框架（老旧机型专供）： :id=OldPhone
   由于原生Xp框架已经~~跑路~~……停止维护了，所以除非是非常老旧的机型，一般情况下我们并不推荐使用它：

   它的安装操作非常繁琐，而且由于年代久远，没法找到配图，安装过程只能进行文字性的叙述：

   >1. 解锁你的手机。然后通过论坛、百度或其他方式找到适合你机型的第三方recovery，最好是`TWRP`(`Team Win Recovery Project`)。然后通过线刷的方式，刷入你的设备；
   >2. 找到适合你当前手机系统的[Xposed框架包](https://dl-xda.xposed.info/framework)。没错，不同的机型，不同的系统，需要的框架包甚至可能存在差异；
   >3. 进入开发者选项，打开高级重启；
   >4. 长按开机键，重启到`recovery（恢复模式）`；
   >5. 进入TWRP后，点击安装，找到你的框架包，刷入；
   >6. 重启手机。
   >7. 开机后，看到桌面上多了一个`Xposed`App，这说明你已经成功了;
   >8. 打开，并给于`Root权限`，[大功告成](#useModule)！

##### EdXposed、太极-阳、LSPosed(Root用户专供)： :id=XpWithMagisk
重头戏终于要来了，相信大多数Xp用户都是使用这三种框架。

看到了这里，相信大家都已经成功Root，并在手机上安装好了Magisk。如果没有，那么请回到[上一步](#Start)。

下面开始安装框架，这里以LSP为例，其他两个类同：

> 1. 打开`Magisk`，点击底栏第四个图标;<br/>
![面具主页](img/面具主页.png ':size=260')
> 2. 进入模块页面后点击搜索按钮，输入`riru`，会自动出来一长串列表，我们需要的是图上这两个：<br/>
![模块页面](img/模块页面.png ':size=260')
![模块搜索](img/模块搜索.png ':size=260')
![模块搜索2](img/模块搜索2.png ':size=260')
> 3.点击下载=>安装，等待自动安装完成:<br/>
![模块搜索3](img/模块搜索3.png ':size=260')
![模块安装1](img/模块安装1.png ':size=260')
![模块安装2](img/模块安装2.jpg ':size=260')
> 4.安装完一个后，先不要重启，退出来安装第二个，全部安装完成后重启手机<br/>
![模块安装3](img/模块安装3.png ':size=260')
> * 重启手机后，如果是`LSP`，安装过程，到这里就已经结束了。

!> `太极`和`EdXposed`则需要再安装一个管理器，下载地址:<br/>
[太极](https://www.coolapk.com/apk/me.weishu.exp)（酷安下载，安全可靠）<br/>
[EdXposed Manager](https://yddown2.jb51.net/202011/tools/EdXposedManager_jb51.apk)(此链接来自百度，不保证安全。原先酷安的已被报复性的下架了。)

#### <font color="#3399cc">第三步、激活模块</font> :id=useModule
下载并安装[自动记账](https://www.coolapk.com/apk/cn.dreamn.qianji_auto)。

**接着开始激活模块：**

>##### 原生Xposed和EdXposed：
>1. 打开`Xposed管理器`（`EdXposed管理器`），进入模块页面；
>2. 激活`自动记账`模块；
>3. 重启手机。
----
>##### LSPosed：
>1. 打开`LSPosed`，点击模块，进入模块页面；
>2. 找到`自动记账`，点进去；
>3. 点进去后会看到一长串的应用列表，最上方有个`开关`，打开它；
>4. 一般来说LSP会自动勾选3个推荐应用：`微信`、`支付宝`、`钱迹`，**不要**自作聪明取消勾选，就这样悄悄地退出去；
>5. 结束运行上面三个应用，无需重启手机;
>6. 重新打开`支付宝`、`微信`，进入`设置`，如果多出一条`自动记账`的选项，那么恭喜你，成功了！
----
>##### 太极-阴（`应用转生`用法可参考此条）：([太极使用文档](https://github.com/taichi-framework/TaiChi/wiki/FAQ))
>1. 点击右下角浮动按钮，然后选择`创建应用`。
>2. 在`创建应用`界面中，选择`微信`、`钱迹`，然后点击最下方的按钮`创建`。
>3. 耐心等待应用创建完成。（这个过程可能会很长，取决于你手机CPU的好坏）
>4. 在太极主页右下角浮动按钮，选择`模块管理`；然后勾选`自动记账`。
>5. 在太极主页的已经创建过的APP列表中，长按列表或者点击右方箭头，选择“强制停止”，然后强制停止`微信`和`钱迹`。
>6. 重新打开`微信`（不需要在太极中打开，从系统桌面打开即可），进入`设置`，如果多出一条`自动记账`的选项，那么恭喜你，成功了！。
----
>##### 太极·阳：
>1. 点击右下角悬浮按钮，`添加应用`（`微信`、`支付宝`、`钱迹`）到太极。
>2. 点击右下角悬浮按钮选择`模块管理`，选择自动记账。
>3. 强制停止应用（指`微信`、`支付宝`、`钱迹`，**不是**`太极`和`自动记账`）即可。
----
到这里为止，所有的准备工作就已经全部做完了。下面开始[进入正式教程](2.权限设置.md)

### 附加内容：
#### <font color="#3399cc">支付宝刷脸解决方案</font>

>1. 酷安下载[【VMOS PRO】](https://www.coolapk.com/apk/com.vmos.pro)
>2. 打开VMOS，添加安卓5.1精简版<br/>
   ![2021021015501616129434161612943416159Mr3e6AIMG_20210210_154919](https://pic.dreamn.cn/uPic/2021021015503216129434321612943432031fzdIoO2021021015501616129434161612943416159Mr3e6AIMG_20210210_154919.jpg ':size=260')
>3. 在虚拟机安装支付宝，登陆支付宝，重新开启人脸识别。
>4. 如果只是为了支付的时候的人脸识别功能，这个时候在真机重新登录支付宝即可。（虚拟机可删除）
>5. 如果是医疗保险之类的人脸识别，请保留该虚拟机。下次人脸识别，请开启虚拟机使用。

<div style="width:50%;float:left;text-align:center;background-color:#f5f6fa">

[上一步(教程说明)](教程说明.md)

</div>
<div style="width:50%;float:right;text-align:center;background-color:#f5f6fa">

[下一步(权限设置)](2.权限设置.md)

</div>